<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
    <title>Weather App</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"></script>
    <style>
        #info { margin-top: 10px; }
        #mapid {
            height: 600px;
            width: 100%;
            z-index: 0;
            cursor: pointer; /* Change the cursor to a pointer when hovering over the map */
        }   
        #coords {
            position: absolute;
            padding: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 3px;
            font-size: 12px;
            pointer-events: none;
            display: none;
            z-index: 1;
        }
    </style>
    <div id="coords"></div>
  </head>
 
   <body>
         <div id="root"></div>

    <div id="mapid"></div>
    <div id="info">
        <p>Temperature: <span id="temperature">N/A</span> °C</p>
        <p>Chance of Rain: <span id="rainChance">N/A</span>%</p>
    </div>
    <script>
        
        var map = L.map('mapid').setView([51.505, -0.09], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        var timeout;
        var coordsDiv = document.getElementById('coords');

        map.on('mousemove', function(e) {
            clearTimeout(timeout);
            coordsDiv.style.display = 'none'; // Hide the box while the mouse is moving

            timeout = setTimeout(function() {
                var lat = e.latlng.lat.toFixed(5);
                var lng = e.latlng.lng.toFixed(5);
                coordsDiv.textContent = `Lat: ${lat}, Lng: ${lng}`;

                // Position the box near the mouse cursor
                coordsDiv.style.left = (e.originalEvent.pageX + 10) + 'px';
                coordsDiv.style.top = (e.originalEvent.pageY + 10) + 'px';
                coordsDiv.style.display = 'block';
            }, 100); // 1 second delay
        });

        map.on('mouseout', function() {
            clearTimeout(timeout);
            coordsDiv.style.display = 'none'; // Hide the box when the mouse leaves the map
        });


        map.on('click', function(e) {
            var lat = e.latlng.lat;
            var lng = e.latlng.lng;

            // Fetch weather data using your API
            fetchWeatherData(lat, lng)
                .then(data => {
                    // Update UI with temperature and chance of rain
                    document.getElementById('temperature').textContent = data.temperature;
                    document.getElementById('rainChance').textContent = data.rainChance;
                })
                .catch(error => {
                    console.error('Error fetching weather data:', error);
                });
        });

        function fetchWeatherData(lat, lng) {
            // Dummy function to simulate API response
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    resolve({
                        temperature: (Math.random() * 30).toFixed(1), // Random temperature between 0 and 30 °C
                        rainChance: (Math.random() * 100).toFixed(1)   // Random chance of rain between 0 and 100%
                    });
                }, 10); // Simulate network delay of 1 second
            });
        }
    </script>
</body>
</html>
